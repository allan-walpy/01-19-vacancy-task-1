language: csharp
solution: project.sln

os: linux
dist: xenial
sudo: enabled

mono: none
dotnet: 2.2

before_script:
  - cp ./src/appsettings.private.example.json ./src/appsettings.private.json

after_failure:
  - cat ./out/log/*.trx

script:
  - dotnet restore --verbosity q
  - dotnet build --configuration Debug --no-restore --verbosity q
  - dotnet build --configuration Release --no-restore --verbosity q
  - dotnet test --configuration Release --no-restore --no-build --verbosity n

notifications:
  email:
    template:
      - "%{author}/%{repository_slug}.%{branch} -> %{commit_message}"
      - "%{result} [%{duration}] -> %{message}"
      - "%{build_url} | %{compare_url}"
    recipients:
      - walpy.notice@gmail.com
    on_success: change
    on_failure: change